var turnOffYearSpan=false,weekStartsOnSunday=false,showWeekNumber=true,languageCode=navigator.browserLanguage,calendar_display_time=true,todayStringFormat="[todayString] [year]\u5e74[monthString]\u6708[day]\u65e5 [UCFdayString]",pathToImages="/MailManager/images/calendar/",speedOfSelectBoxSliding=200,intervalSelectBox_minutes=5,calendar_offsetTop=0,calendar_offsetLeft=0,calendarDiv=false,MSIE=false,Opera=false;if(navigator.userAgent.indexOf("MSIE")>=0&&navigator.userAgent.indexOf("Opera")<0)MSIE=true;if(navigator.userAgent.indexOf("Opera")>=0)Opera=true;switch(languageCode){case"en":var monthArray=["January","February","March","April","May","June","July","August","September","October","November","December"],monthArrayShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayArray=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],weekString="Week",todayString="Current Date";break;case"zh-cn":var monthArray=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],monthArrayShort=["1","2","3","4","5","6","7","8","9","10","11","12"],dayArray=["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u65e5"],dayArrayShort=["\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d","\u5468\u65e5"],weekString="\u5468",todayString="\u5f53\u524d\u65e5\u671f"}if(weekStartsOnSunday){for(var tempDayName=dayArray[6],theIx=6;theIx>0;theIx--)dayArray[theIx]=dayArray[theIx-1];dayArray[0]=tempDayName}var daysInMonthArray=[31,28,31,30,31,30,31,31,30,31,30,31],currentMonth,currentYear,currentHour,currentMinute,calendarContentDiv,returnDateTo,returnFormat,activeSelectBoxMonth,activeSelectBoxYear,activeSelectBoxHour,activeSelectBoxMinute,iframeObj=false,iframeObj2=false;function EIS_FIX_EI1(a){if(!iframeObj2)return;iframeObj2.style.display="block";iframeObj2.style.height=document.getElementById(a).offsetHeight+1;iframeObj2.style.width=document.getElementById(a).offsetWidth;iframeObj2.style.left=getleftPos(document.getElementById(a))+1-calendar_offsetLeft;iframeObj2.style.top=getTopPos(document.getElementById(a))-document.getElementById(a).offsetHeight-calendar_offsetTop}function EIS_Hide_Frame(){if(iframeObj2)iframeObj2.style.display="none"}var returnDateToYear,returnDateToMonth,returnDateToDay,returnDateToHour,returnDateToMinute,inputYear,inputMonth,inputDay,inputHour,inputMinute,calendarDisplayTime=false,selectBoxHighlightColor="#D60808",selectBoxRolloverBgColor="#E2EBED",selectBoxMovementInProgress=false,activeSelectBox=false;function cancelCalendarEvent(){return false}function isLeapYear(a){return a%400==0||a%4==0&&a%100!=0?true:false}var activeSelectBoxMonth=false,activeSelectBoxDirection=false;function highlightMonthYear(){if(activeSelectBoxMonth)activeSelectBoxMonth.className="";activeSelectBox=this;if(this.className=="monthYearActive")this.className="";else{this.className="monthYearActive";activeSelectBoxMonth=this}if(this.innerHTML.indexOf("-")>=0||this.innerHTML.indexOf("+")>=0){if(this.className=="monthYearActive")selectBoxMovementInProgress=true;else selectBoxMovementInProgress=false;if(this.innerHTML.indexOf("-")>=0)activeSelectBoxDirection=-1;else activeSelectBoxDirection=1}else selectBoxMovementInProgress=false}function showMonthDropDown(){if(document.getElementById("monthDropDown").style.display=="block"){document.getElementById("monthDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("monthDropDown").style.display="block";document.getElementById("yearDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";MSIE&&EIS_FIX_EI1("monthDropDown")}}function showYearDropDown(){if(document.getElementById("yearDropDown").style.display=="block"){document.getElementById("yearDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("yearDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";MSIE&&EIS_FIX_EI1("yearDropDown")}}function showHourDropDown(){if(document.getElementById("hourDropDown").style.display=="block"){document.getElementById("hourDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("hourDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("yearDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";MSIE&&EIS_FIX_EI1("hourDropDown")}}function showMinuteDropDown(){if(document.getElementById("minuteDropDown").style.display=="block"){document.getElementById("minuteDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("minuteDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("yearDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";MSIE&&EIS_FIX_EI1("minuteDropDown")}}function selectMonth(){document.getElementById("calendar_month_txt").innerHTML=this.innerHTML;currentMonth=this.id.replace(/[^\d]/g,"");document.getElementById("monthDropDown").style.display="none";EIS_Hide_Frame();for(var a=0;a<monthArray.length;a++)document.getElementById("monthDiv_"+a).style.color="";this.style.color=selectBoxHighlightColor;activeSelectBoxMonth=this;writeCalendarContent()}function selectHour(){document.getElementById("calendar_hour_txt").innerHTML=this.innerHTML;currentHour=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("hourDropDown").style.display="none";EIS_Hide_Frame();if(activeSelectBoxHour)activeSelectBoxHour.style.color="";activeSelectBoxHour=this;this.style.color=selectBoxHighlightColor}function selectMinute(){document.getElementById("calendar_minute_txt").innerHTML=this.innerHTML;currentMinute=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("minuteDropDown").style.display="none";EIS_Hide_Frame();if(activeSelectBoxMinute)activeSelectBoxMinute.style.color="";activeSelectBoxMinute=this;this.style.color=selectBoxHighlightColor}function selectYear(){document.getElementById("calendar_year_txt").innerHTML=this.innerHTML;currentYear=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("yearDropDown").style.display="none";EIS_Hide_Frame();if(activeSelectBoxYear)activeSelectBoxYear.style.color="";activeSelectBoxYear=this;this.style.color=selectBoxHighlightColor;writeCalendarContent()}function switchMonth(){if(this.src.indexOf("left")>=0){currentMonth=currentMonth-1;if(currentMonth<0){currentMonth=11;currentYear=currentYear-1}}else{currentMonth=currentMonth+1;if(currentMonth>11){currentMonth=0;currentYear=currentYear/1+1}}writeCalendarContent()}function createMonthDiv(){var c=document.createElement("DIV");c.className="monthYearPicker";c.id="monthPicker";for(var b=0;b<monthArray.length;b++){var a=document.createElement("DIV");a.innerHTML=monthArray[b];a.onmouseover=highlightMonthYear;a.onmouseout=highlightMonthYear;a.onclick=selectMonth;a.id="monthDiv_"+b;a.style.width="56px";a.onselectstart=cancelCalendarEvent;c.appendChild(a);if(currentMonth&&currentMonth==b){a.style.color=selectBoxHighlightColor;activeSelectBoxMonth=a}}return c}function changeSelectBoxYear(e,c){if(!c)c=this;var b=c.parentNode.getElementsByTagName("DIV");if(c.innerHTML.indexOf("-")>=0){var d=b[1].innerHTML/1-1;if(activeSelectBoxYear)activeSelectBoxYear.style.color=""}else{var d=b[1].innerHTML/1+1;if(activeSelectBoxYear)activeSelectBoxYear.style.color=""}for(var a=1;a<b.length-1;a++){b[a].innerHTML=d+a-1;b[a].id="yearDiv"+(d/1+a/1-1)}if(activeSelectBoxYear){activeSelectBoxYear.style.color="";if(document.getElementById("yearDiv"+currentYear)){activeSelectBoxYear=document.getElementById("yearDiv"+currentYear);activeSelectBoxYear.style.color=selectBoxHighlightColor}}}function changeSelectBoxHour(f,d){if(!d)d=this;var c=d.parentNode.getElementsByTagName("DIV");if(d.innerHTML.indexOf("-")>=0){var a=c[1].innerHTML/1-1;if(a<0)a=0;if(activeSelectBoxHour)activeSelectBoxHour.style.color=""}else{var a=c[1].innerHTML/1+1;if(a>14)a=14;if(activeSelectBoxHour)activeSelectBoxHour.style.color=""}for(var e="",b=1;b<c.length-1;b++){if(a/1+b/1<11)e="0";else e="";c[b].innerHTML=e+(a+b-1);c[b].id="hourDiv"+(a/1+b/1-1)}if(activeSelectBoxHour){activeSelectBoxHour.style.color="";if(document.getElementById("hourDiv"+currentHour)){activeSelectBoxHour=document.getElementById("hourDiv"+currentHour);activeSelectBoxHour.style.color=selectBoxHighlightColor}}}function updateYearDiv(){var c=5;if(turnOffYearSpan)c=0;for(var d=document.getElementById("yearDropDown"),b=d.getElementsByTagName("DIV"),a=1;a<b.length-1;a++){b[a].innerHTML=currentYear/1-c+a;if(currentYear==currentYear/1-c+a){b[a].style.color=selectBoxHighlightColor;activeSelectBoxYear=b[a]}else b[a].style.color=""}}function updateMonthDiv(){for(no=0;no<12;no++)document.getElementById("monthDiv_"+no).style.color="";document.getElementById("monthDiv_"+currentMonth).style.color=selectBoxHighlightColor;activeSelectBoxMonth=document.getElementById("monthDiv_"+currentMonth)}function updateHourDiv(){var e=document.getElementById("hourDropDown"),b=e.getElementsByTagName("DIV"),c=0;if(currentHour/1-6+1<0)c=(currentHour/1-6+1)*-1;for(var a=1;a<b.length-1;a++){var d="";if(currentHour/1-6+a+c<10)d="0";b[a].innerHTML=d+(currentHour/1-6+a+c);if(currentHour==currentHour/1-6+a){b[a].style.color=selectBoxHighlightColor;activeSelectBoxHour=b[a]}else b[a].style.color=""}}function updateMinuteDiv(){for(no=0;no<60;no+=intervalSelectBox_minutes){var a="";if(no<10)a="0";document.getElementById("minuteDiv_"+a+no).style.color=""}if(document.getElementById("minuteDiv_"+currentMinute)){document.getElementById("minuteDiv_"+currentMinute).style.color=selectBoxHighlightColor;activeSelectBoxMinute=document.getElementById("minuteDiv_"+currentMinute)}}function createYearDiv(){if(!document.getElementById("yearDropDown")){var c=document.createElement("DIV");c.className="monthYearPicker"}else for(var c=document.getElementById("yearDropDown"),e=c.getElementsByTagName("DIV"),b=0;b<e.length;b++)e[b].parentNode.removeChild(e[b]);var f=new Date;currentYear&&f.setFullYear(currentYear);var d=f.getFullYear()/1-5,g=10;if(!turnOffYearSpan){var a=document.createElement("DIV");a.innerHTML="&nbsp;&nbsp;- ";a.onclick=changeSelectBoxYear;a.onmouseover=highlightMonthYear;a.onmouseout=function(){selectBoxMovementInProgress=false};a.onselectstart=cancelCalendarEvent;c.appendChild(a)}else{d=f.getFullYear()/1-0;g=2}for(var b=d;b<d+g;b++){var a=document.createElement("DIV");a.innerHTML=b;a.onmouseover=highlightMonthYear;a.onmouseout=highlightMonthYear;a.onclick=selectYear;a.id="yearDiv"+b;a.onselectstart=cancelCalendarEvent;c.appendChild(a);if(currentYear&&currentYear==b){a.style.color=selectBoxHighlightColor;activeSelectBoxYear=a}}if(!turnOffYearSpan){var a=document.createElement("DIV");a.innerHTML="&nbsp;&nbsp;+ ";a.onclick=changeSelectBoxYear;a.onmouseover=highlightMonthYear;a.onmouseout=function(){selectBoxMovementInProgress=false};a.onselectstart=cancelCalendarEvent;c.appendChild(a)}return c}function slideCalendarSelectBox(){if(selectBoxMovementInProgress){activeSelectBox.parentNode.id=="hourDropDown"&&changeSelectBoxHour(false,activeSelectBox);activeSelectBox.parentNode.id=="yearDropDown"&&changeSelectBoxYear(false,activeSelectBox)}setTimeout("slideCalendarSelectBox()",speedOfSelectBoxSliding)}function createHourDiv(){if(!document.getElementById("hourDropDown")){var c=document.createElement("DIV");c.className="monthYearPicker"}else for(var c=document.getElementById("hourDropDown"),e=c.getElementsByTagName("DIV"),b=0;b<e.length;b++)e[b].parentNode.removeChild(e[b]);if(!currentHour)currentHour=0;var d=currentHour/1;if(d>14)d=14;var a=document.createElement("DIV");a.innerHTML="&nbsp;&nbsp;- ";a.onclick=changeSelectBoxHour;a.onmouseover=highlightMonthYear;a.onmouseout=function(){selectBoxMovementInProgress=false};a.onselectstart=cancelCalendarEvent;c.appendChild(a);for(var b=d;b<d+10;b++){var f="";if(b/1<10)f="0";var a=document.createElement("DIV");a.innerHTML=f+b;a.onmouseover=highlightMonthYear;a.onmouseout=highlightMonthYear;a.onclick=selectHour;a.id="hourDiv"+b;a.onselectstart=cancelCalendarEvent;c.appendChild(a);if(currentYear&&currentYear==b){a.style.color=selectBoxHighlightColor;activeSelectBoxYear=a}}var a=document.createElement("DIV");a.innerHTML="&nbsp;&nbsp;+ ";a.onclick=changeSelectBoxHour;a.onmouseover=highlightMonthYear;a.onmouseout=function(){selectBoxMovementInProgress=false};a.onselectstart=cancelCalendarEvent;c.appendChild(a);return c}function createMinuteDiv(){if(!document.getElementById("minuteDropDown")){var d=document.createElement("DIV");d.className="monthYearPicker"}else for(var d=document.getElementById("minuteDropDown"),e=d.getElementsByTagName("DIV"),a=0;a<e.length;a++)e[a].parentNode.removeChild(e[a]);for(var f=0,c="",a=f;a<60;a+=intervalSelectBox_minutes){if(a<10)c="0";else c="";var b=document.createElement("DIV");b.innerHTML=c+a;b.onmouseover=highlightMonthYear;b.onmouseout=highlightMonthYear;b.onclick=selectMinute;b.id="minuteDiv_"+c+a;b.onselectstart=cancelCalendarEvent;d.appendChild(b);if(currentYear&&currentYear==a){b.style.color=selectBoxHighlightColor;activeSelectBoxYear=b}}return d}function highlightSelect(){if(this.className=="selectBoxTime"){this.className="selectBoxTimeOver";this.getElementsByTagName("IMG")[0].src=pathToImages+"down_time_over.gif"}else if(this.className=="selectBoxTimeOver"){this.className="selectBoxTime";this.getElementsByTagName("IMG")[0].src=pathToImages+"down_time.gif"}if(this.className=="selectBox"){this.className="selectBoxOver";this.getElementsByTagName("IMG")[0].src=pathToImages+"down_over.gif"}else if(this.className=="selectBoxOver"){this.className="selectBox";this.getElementsByTagName("IMG")[0].src=pathToImages+"down.gif"}}function highlightArrow(){if(this.src.indexOf("over")>=0){if(this.src.indexOf("left")>=0)this.src=pathToImages+"left.gif";if(this.src.indexOf("right")>=0)this.src=pathToImages+"right.gif"}else{if(this.src.indexOf("left")>=0)this.src=pathToImages+"left_over.gif";if(this.src.indexOf("right")>=0)this.src=pathToImages+"right_over.gif"}}function highlightClose(){if(this.src.indexOf("over")>=0)this.src=pathToImages+"close.gif";else this.src=pathToImages+"close_over.gif"}function closeCalendar(){document.getElementById("yearDropDown").style.display="none";document.getElementById("monthDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";calendarDiv.style.display="none";if(iframeObj){iframeObj.style.display="none";EIS_Hide_Frame()}if(activeSelectBoxMonth)activeSelectBoxMonth.className="";if(activeSelectBoxYear)activeSelectBoxYear.className=""}function writeTopBar(){var d=document.createElement("DIV");d.className="topBar";d.id="topBar";calendarDiv.appendChild(d);var i=document.createElement("DIV");i.style.marginRight="1px";var a=document.createElement("IMG");a.src=pathToImages+"left.gif";a.onmouseover=highlightArrow;a.onclick=switchMonth;a.onmouseout=highlightArrow;i.appendChild(a);d.appendChild(i);if(Opera)i.style.width="16px";var h=document.createElement("DIV");h.style.marginRight="1px";var a=document.createElement("IMG");a.src=pathToImages+"right.gif";a.onclick=switchMonth;a.onmouseover=highlightArrow;a.onmouseout=highlightArrow;h.appendChild(a);if(Opera)h.style.width="16px";d.appendChild(h);var b=document.createElement("DIV");b.id="monthSelect";b.onmouseover=highlightSelect;b.onmouseout=highlightSelect;b.onclick=showMonthDropDown;var e=document.createElement("SPAN");e.innerHTML=monthArray[currentMonth];e.id="calendar_month_txt";b.appendChild(e);var a=document.createElement("IMG");a.src=pathToImages+"down.gif";a.style.position="absolute";a.style.right="0px";b.appendChild(a);b.className="selectBox";if(Opera){a.style.cssText="float:right;position:relative";a.style.position="relative";a.style.styleFloat="right"}d.appendChild(b);var f=createMonthDiv();f.style.left="37px";f.style.top=b.offsetTop+b.offsetHeight+1+"px";f.style.width="60px";f.id="monthDropDown";calendarDiv.appendChild(f);var c=document.createElement("DIV");c.onmouseover=highlightSelect;c.onmouseout=highlightSelect;c.onclick=showYearDropDown;var e=document.createElement("SPAN");e.innerHTML=currentYear;e.id="calendar_year_txt";c.appendChild(e);d.appendChild(c);var a=document.createElement("IMG");a.src=pathToImages+"down.gif";c.appendChild(a);c.className="selectBox";if(Opera){c.style.width="50px";a.style.cssText="float:right";a.style.position="relative";a.style.styleFloat="right"}var g=createYearDiv();g.style.left="113px";g.style.top=b.offsetTop+b.offsetHeight+1+"px";g.style.width="35px";g.id="yearDropDown";calendarDiv.appendChild(g);var a=document.createElement("IMG");a.src=pathToImages+"close.gif";a.style.styleFloat="right";a.onmouseover=highlightClose;a.onmouseout=highlightClose;a.onclick=closeCalendar;d.appendChild(a);if(!document.all){a.style.position="absolute";a.style.right="2px"}}function writeCalendarContent(){var j=true;if(!calendarContentDiv){calendarContentDiv=document.createElement("DIV");calendarDiv.appendChild(calendarContentDiv);j=false}currentMonth=currentMonth/1;var e=new Date;e.setFullYear(currentYear);e.setDate(1);e.setMonth(currentMonth);var d=e.getDay();if(!weekStartsOnSunday){if(d==0)d=7;d--}document.getElementById("calendar_year_txt").innerHTML=currentYear;document.getElementById("calendar_month_txt").innerHTML=monthArray[currentMonth];document.getElementById("calendar_hour_txt").innerHTML=currentHour/1>9?currentHour:"0"+currentHour;document.getElementById("calendar_minute_txt").innerHTML=currentMinute/1>9?currentMinute:"0"+currentMinute;var k=calendarContentDiv.getElementsByTagName("TABLE");k.length>0&&calendarContentDiv.removeChild(k[0]);var f=document.createElement("TABLE");f.width="100%";f.cellSpacing="0";calendarContentDiv.appendChild(f);var g=document.createElement("TBODY");f.appendChild(g);var c=g.insertRow(-1);c.className="calendar_week_row";if(showWeekNumber){var a=c.insertCell(-1);a.innerHTML=weekString;a.className="calendar_week_column";a.style.backgroundColor=selectBoxRolloverBgColor}for(var b=0;b<dayArray.length;b++){var a=c.insertCell(-1);a.innerHTML=dayArray[b]}var c=g.insertRow(-1);if(showWeekNumber){var a=c.insertCell(-1);a.className="calendar_week_column";a.style.backgroundColor=selectBoxRolloverBgColor;var l=getWeek(currentYear,currentMonth,1);a.innerHTML=l}for(var b=0;b<d;b++){var a=c.insertCell(-1);a.innerHTML="&nbsp;"}var i=d,h=daysInMonthArray[currentMonth];if(h==28)if(isLeapYear(currentYear))h=29;for(var b=1;b<=h;b++){e.setDate(b-1);if(i>0&&i%7==0){var c=g.insertRow(-1);if(showWeekNumber){var a=c.insertCell(-1);a.className="calendar_week_column";var l=getWeek(currentYear,currentMonth,b);a.innerHTML=l;a.style.backgroundColor=selectBoxRolloverBgColor}}var a=c.insertCell(-1);if(currentYear==inputYear&&currentMonth==inputMonth&&b==inputDay)a.className="activeDay";a.innerHTML=b;a.onclick=pickDate;i++}if(!document.all)if(calendarContentDiv.offsetHeight)document.getElementById("topBar").style.top=calendarContentDiv.offsetHeight+document.getElementById("timeBar").offsetHeight+document.getElementById("topBar").offsetHeight-1+"px";else{document.getElementById("topBar").style.top="";document.getElementById("topBar").style.bottom="0px"}if(iframeObj)if(!j)setTimeout("resizeIframe()",350);else setTimeout("resizeIframe()",10)}function resizeIframe(){iframeObj.style.width=calendarDiv.offsetWidth+"px";iframeObj.style.height=calendarDiv.offsetHeight+"px"}function pickTodaysDate(){var a=new Date;currentMonth=a.getMonth();currentYear=a.getFullYear();pickDate(false,a.getDate())}function pickDate(e,d){var c=currentMonth/1+1;if(c<10)c="0"+c;var b;if(!d&&this)b=this.innerHTML;else b=d;if(b/1<10)b="0"+b;if(returnFormat){returnFormat=returnFormat.replace("dd",b);returnFormat=returnFormat.replace("mm",c);returnFormat=returnFormat.replace("yyyy",currentYear);returnFormat=returnFormat.replace("hh",currentHour);returnFormat=returnFormat.replace("ii",currentMinute);returnFormat=returnFormat.replace("d",b/1);returnFormat=returnFormat.replace("m",c/1);returnDateTo.value=returnFormat;try{returnDateTo.onchange()}catch(e){}}else{for(var a=0;a<returnDateToYear.options.length;a++)if(returnDateToYear.options[a].value==currentYear){returnDateToYear.selectedIndex=a;break}for(var a=0;a<returnDateToMonth.options.length;a++)if(returnDateToMonth.options[a].value==parseFloat(c)){returnDateToMonth.selectedIndex=a;break}for(var a=0;a<returnDateToDay.options.length;a++)if(returnDateToDay.options[a].value==parseFloat(b)){returnDateToDay.selectedIndex=a;break}if(calendarDisplayTime){for(var a=0;a<returnDateToHour.options.length;a++)if(returnDateToHour.options[a].value==parseFloat(currentHour)){returnDateToHour.selectedIndex=a;break}for(var a=0;a<returnDateToMinute.options.length;a++)if(returnDateToMinute.options[a].value==parseFloat(currentMinute)){returnDateToMinute.selectedIndex=a;break}}}closeCalendar()}function getWeek(d,b,a){if(!weekStartsOnSunday)a=a/1;else a=a/1+1;d=d/1;b=b/1+1;var g=Math.floor((14-b)/12),c=d+4800-g,j=b+12*g-3,f=a+Math.floor((153*j+2)/5)+365*c+Math.floor(c/4)-Math.floor(c/100)+Math.floor(c/400)-32045,e=(f+31741-f%7)%146097%36524%1461,h=Math.floor(e/1460),i=(e-h)%365+h;NumberOfWeek=Math.floor(i/7)+1;return NumberOfWeek}function writeTimeBar(){var e=document.createElement("DIV");e.id="timeBar";e.className="timeBar";var h=document.createElement("DIV");h.innerHTML="Time:";var c=document.createElement("DIV");c.onmouseover=highlightSelect;c.onmouseout=highlightSelect;c.onclick=showHourDropDown;c.style.width="30px";var d=document.createElement("SPAN");d.innerHTML=currentHour;d.id="calendar_hour_txt";c.appendChild(d);e.appendChild(c);var a=document.createElement("IMG");a.src=pathToImages+"down_time.gif";c.appendChild(a);c.className="selectBoxTime";if(Opera){c.style.width="30px";a.style.cssText="float:right";a.style.position="relative";a.style.styleFloat="right"}var g=createHourDiv();g.style.left="130px";g.style.width="35px";g.id="hourDropDown";calendarDiv.appendChild(g);var b=document.createElement("DIV");b.onmouseover=highlightSelect;b.onmouseout=highlightSelect;b.onclick=showMinuteDropDown;b.style.width="30px";var d=document.createElement("SPAN");d.innerHTML=currentMinute;d.id="calendar_minute_txt";b.appendChild(d);e.appendChild(b);var a=document.createElement("IMG");a.src=pathToImages+"down_time.gif";b.appendChild(a);b.className="selectBoxTime";if(Opera){b.style.width="30px";a.style.cssText="float:right";a.style.position="relative";a.style.styleFloat="right"}var f=createMinuteDiv();f.style.left="167px";f.style.width="35px";f.id="minuteDropDown";calendarDiv.appendChild(f);return e}function writeBottomBar(){var e=new Date,b=document.createElement("DIV");b.id="bottomBar";b.style.cursor="pointer";b.className="todaysDate";var c=document.createElement("DIV");c.onclick=pickTodaysDate;c.id="todaysDateString";c.style.width=calendarDiv.offsetWidth-95+"px";var d=e.getDay();if(!weekStartsOnSunday){if(d==0)d=7;d--}var a=todayStringFormat;a=a.replace("[monthString]",monthArrayShort[e.getMonth()]);a=a.replace("[day]",e.getDate());a=a.replace("[year]",e.getFullYear());a=a.replace("[dayString]",dayArray[d].toLowerCase());a=a.replace("[UCFdayString]",dayArrayShort[d]);a=a.replace("[todayString]",todayString);c.innerHTML=a;b.appendChild(c);var f=writeTimeBar();b.appendChild(f);calendarDiv.appendChild(b)}function getTopPos(a){var b=a.offsetTop+a.offsetHeight;while((a=a.offsetParent)!=null)b+=a.offsetTop;return b+calendar_offsetTop}function getleftPos(a){var b=a.offsetLeft;while((a=a.offsetParent)!=null)b+=a.offsetLeft;return b+calendar_offsetLeft}function positionCalendar(a){calendarDiv.style.left=getleftPos(a)+"px";calendarDiv.style.top=getTopPos(a)+"px";if(iframeObj){iframeObj.style.left=calendarDiv.style.left;iframeObj.style.top=calendarDiv.style.top;iframeObj2.style.left=calendarDiv.style.left;iframeObj2.style.top=calendarDiv.style.top}}function initCalendar(){if(MSIE){iframeObj=document.createElement("IFRAME");iframeObj.style.filter="alpha(opacity=0)";iframeObj.style.position="absolute";iframeObj.border="0px";iframeObj.style.border="0px";iframeObj.style.backgroundColor="#FF0000";iframeObj2=document.createElement("IFRAME");iframeObj2.style.position="absolute";iframeObj2.border="0px";iframeObj2.style.border="0px";iframeObj2.style.height="1px";iframeObj2.style.width="1px";iframeObj2.src="blank.html";iframeObj.src="blank.html";document.body.appendChild(iframeObj2);document.body.appendChild(iframeObj)}calendarDiv=document.createElement("DIV");calendarDiv.id="calendarDiv";calendarDiv.style.zIndex=1e3;slideCalendarSelectBox();document.body.appendChild(calendarDiv);writeBottomBar();writeTopBar();if(!currentYear){var a=new Date;currentMonth=a.getMonth();currentYear=a.getFullYear()}writeCalendarContent()}function setTimeProperties(){if(!calendarDisplayTime){document.getElementById("timeBar").style.display="none";document.getElementById("timeBar").style.visibility="hidden";document.getElementById("todaysDateString").style.width="100%"}else{document.getElementById("timeBar").style.display="block";document.getElementById("timeBar").style.visibility="visible";document.getElementById("hourDropDown").style.top=document.getElementById("calendar_minute_txt").parentNode.offsetHeight+calendarContentDiv.offsetHeight+document.getElementById("topBar").offsetHeight+"px";document.getElementById("minuteDropDown").style.top=document.getElementById("calendar_minute_txt").parentNode.offsetHeight+calendarContentDiv.offsetHeight+document.getElementById("topBar").offsetHeight+"px";document.getElementById("minuteDropDown").style.right="50px";document.getElementById("hourDropDown").style.right="50px";document.getElementById("todaysDateString").style.width="115px"}}function calendarSortItems(a,b){return a/1-b/1}function displayCalendar(c,a,l,j){if(j)calendarDisplayTime=true;else calendarDisplayTime=false;if(c.value.length>6)if(!c.value.match(/^[0-9]*?$/gi)){var q=c.value.split(/[^0-9]/gi),b={};b.m=a.indexOf("mm");if(b.m==-1)b.m=a.indexOf("m");b.d=a.indexOf("dd");if(b.d==-1)b.d=a.indexOf("d");b.y=a.indexOf("yyyy");b.h=a.indexOf("hh");b.i=a.indexOf("ii");this.initialHour="00";this.initialMinute="00";for(var e=["y","m","d","h","i"],k=["currentYear","currentMonth","inputDay","currentHour","currentMinute"],i=[4,2,2,2,2],d=0;d<e.length;d++)if(b[e[d]]>=0)window[k[d]]=c.value.substr(b[e[d]],i[d])/1;currentMonth--}else{var m=a.indexOf("mm");currentMonth=c.value.substr(m,2)/1-1;var n=a.indexOf("yyyy");currentYear=c.value.substr(n,4);var o=a.indexOf("dd");tmpDay=c.value.substr(o,2);var h=a.indexOf("hh");if(h>=0){tmpHour=c.value.substr(h,2);currentHour=tmpHour;if(currentHour.length==1)currentHour="0"}else currentHour="00";var g=a.indexOf("ii");if(g>=0){tmpMinute=c.value.substr(g,2);currentMinute=tmpMinute}else currentMinute="00"}else{var f=new Date;currentMonth=f.getMonth();currentYear=f.getFullYear();currentHour="08";currentMinute="00";inputDay=f.getDate()/1}inputYear=currentYear;inputMonth=currentMonth;if(!calendarDiv)initCalendar();else{if(calendarDiv.style.display=="block"){closeCalendar();return false}writeCalendarContent()}returnFormat=a;returnDateTo=c;positionCalendar(l);calendarDiv.style.visibility="visible";calendarDiv.style.display="block";if(iframeObj){iframeObj.style.display="";iframeObj.style.height="140px";iframeObj.style.width="195px";iframeObj2.style.display="";iframeObj2.style.height="140px";iframeObj2.style.width="195px"}setTimeProperties();updateYearDiv();updateMonthDiv();updateMinuteDiv();updateHourDiv()}function displayCalendarSelectBox(c,a,e,b,d,f){if(!b)calendarDisplayTime=false;else calendarDisplayTime=true;currentMonth=a.options[a.selectedIndex].value/1-1;currentYear=c.options[c.selectedIndex].value;if(b){currentHour=b.options[b.selectedIndex].value;inputHour=currentHour/1}if(d){currentMinute=d.options[d.selectedIndex].value;inputMinute=currentMinute/1}inputYear=c.options[c.selectedIndex].value;inputMonth=a.options[a.selectedIndex].value/1-1;inputDay=e.options[e.selectedIndex].value/1;if(!calendarDiv)initCalendar();else writeCalendarContent();returnDateToYear=c;returnDateToMonth=a;returnDateToDay=e;returnDateToHour=b;returnDateToMinute=d;returnFormat=false;returnDateTo=false;positionCalendar(f);calendarDiv.style.visibility="visible";calendarDiv.style.display="block";if(iframeObj){iframeObj.style.display="";iframeObj.style.height=calendarDiv.offsetHeight+"px";iframeObj.style.width=calendarDiv.offsetWidth+"px";iframeObj2.style.display="";iframeObj2.style.height=calendarDiv.offsetHeight+"px";iframeObj2.style.width=calendarDiv.offsetWidth+"px"}setTimeProperties();updateYearDiv();updateMonthDiv();updateHourDiv();updateMinuteDiv()}